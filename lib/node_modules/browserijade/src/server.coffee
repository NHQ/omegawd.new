# Browserijade
# (c) 2011 David Ed Mellum
# Browserijade may be freely distributed under the MIT license.

fs = require 'fs'

_ = require 'underscore'

middleware = require './middleware'
jade = require 'jade'

# Render a pre-compiled Jade template in a self-executing closure.
renderString = (template)->
	eval template

renderFile = (path, locals, callback)->
	locals ?= {}
	filename = "#{path}.jade"
	fs.readFile filename, 'utf8', (err, template)->
		compiled = jade.compile template, {locals, filename}
		callback compiled()

module.exports = middleware

_.extend module.exports, {
	renderString
	renderFile
}